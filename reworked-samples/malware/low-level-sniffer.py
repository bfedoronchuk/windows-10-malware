import socket


def listen_traffic():
    sniffer_socket = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)

    host_name = socket.gethostname()
    host_ip = socket.gethostbyname(host_name)
    port = 0  # means random port will be bound
    print("Host name: " + host_name)
    print("Host IP: " + host_ip)
    sniffer_socket.bind((host_ip, port))

    # include IP protocol headers
    sniffer_socket.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, 1)

    # receive all information
    sniffer_socket.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)

    udp_packet_maximum_size = 65535
    buffer_size = udp_packet_maximum_size + 1
    needed_domain = 'amazon.com'
    while True:
        result = sniffer_socket.recvfrom(buffer_size)
        data = result[0]
        if needed_domain in str(data):
            print('=' * 20)
            print(data)


listen_traffic()
