import socket
from time import sleep


def _has_stable_connection() -> bool:
    try:
        socket.create_connection(('www.google.com', 80))
        return True
    except:
        return False


def execute_on_stable_connection(func: callable):
    """
    Executes any callable when internet connectivity becomes stable.
    Usage:
    execute_on_stable_connection(lambda: print("Stable connection!"))
    """
    while not _has_stable_connection():
        print('No stable connection...')
        sleep(5)
    func()

